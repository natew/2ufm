<%-
  counter = @locals.delete(:counter)
  add = counter == :add
-%>

var song = $('#song-<%= @locals[:id] %>'),
    broadcast = song.find('.broadcast'),
    count = parseInt(broadcast.children('a').html(),10);

<%= add %> ? count++ : count--;
<%= add %> ? song.addClass('liked') : song.removeClass('liked');
broadcast.html("<%= escape_javascript(render :partial => 'songs/broadcast', :locals => @locals) %>");
broadcast.children('a').html(count);
