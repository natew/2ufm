<!doctype html>
<html lang="en">
<head>
  <!-- Meta -->
  <meta charset="utf-8">
  <%= csrf_meta_tag %>
  <meta name="author" content="Nate Wienert">
  <meta http-equiv="X-UA-Compatible" content="IE=edge,chrome=1">
  <meta name="viewport" content="width=device-width, initial-scale=1, maximum-scale=1">

  <%- if params[:listen]
        @listen_song = Song.find(params[:listen_song_id]) -%>
    <!-- OpenGraph -->
    <meta property="og:title" content="<%= @listen_song.full_name %>" />
    <meta property="og:description" content="Listen now on 2u.fm" />
    <meta property="og:image" content="<%= @listen_song.resolve_image %>" />
  <%- else -%>
    <meta property="og:title" content="<%= title %>" />
    <meta property="og:description" content="Listen to new music on 2u.fm" />
    <meta property="og:image" content="http://2u.fm/images/2ufm-standalone.png" />
  <%- end -%>

  <title><%= title %></title>

  <!-- HTML5 shim, for IE6-8 support of HTML elements -->
  <!--[if lt IE 9]>
    <script src="http://html5shim.googlecode.com/svn/trunk/html5.js"></script>
  <![endif]-->

  <%= stylesheet_link_tag "application", :debug => Rails.env.development? %>
  <link href='http://fonts.googleapis.com/css?family=Open+Sans:300,400,700' rel='stylesheet' type='text/css'>

  <script type="text/javascript">
    var _gaq = _gaq || [];
    _gaq.push(['_setAccount', 'UA-32843361-1']);
    _gaq.push(['_trackPageview']);
    (function() {
      var ga = document.createElement('script'); ga.type = 'text/javascript'; ga.async = true;
      ga.src = ('https:' == document.location.protocol ? 'https://ssl' : 'http://www') + '.google-analytics.com/ga.js';
      var s = document.getElementsByTagName('script')[0]; s.parentNode.insertBefore(ga, s);
    })();

    _prf_start = new Date().getTime();
  </script>

  <script type="text/javascript">
    var updateBroadcastsIds, updateListensIds, updateBroadcastsCounts,
        broadcastedIds = [], updateFollowsIds = [];

    <%- if user_signed_in? -%>
      beginListen = <%= raw current_user.listens.last.as_json.to_json %>;
    <%- else -%>
      beginListen = false;
    <%- end -%>
  </script>
</head>

<body class="<%= body_classes %>" data-soundcloud-key="<%= Yetting.soundcloud_key %>" data-media="<%= Yetting.s3_url %>"<% if user_signed_in? %> data-user="<%= current_user.id %>" <% if current_user.can_download? %> data-role="admin"<% end %><% end %>>
  <%= render template: 'layouts/full' %>
</body>
</html>