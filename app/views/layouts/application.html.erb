<!doctype html>
<html lang="en">
<head>
  <title>2u.fm</title>

  <!-- Meta -->
  <meta charset="utf-8">
  <%= csrf_meta_tag %>
  <meta name="description" content="">
  <meta name="author" content="Nate Wienert">
  <meta http-equiv="X-UA-Compatible" content="IE=edge,chrome=1">

  <!-- TODO: remove -->
  <meta name="robots" content="noindex">

  <!-- HTML5 shim, for IE6-8 support of HTML elements -->
  <!--[if lt IE 9]>
    <script src="http://html5shim.googlecode.com/svn/trunk/html5.js"></script>
  <![endif]-->

  <%= stylesheet_link_tag "application", :debug => Rails.env.development? %>
  <link href='http://fonts.googleapis.com/css?family=Lato:400,700' rel='stylesheet' type='text/css' />
</head>

<body class="<%= user_signed_in? ? 'signed_in' : 'signed_out' %> wizard">
  <header>
    <h1><%= link_to '2u.fm', '/', :class => 'tip-n', :title => 'Go Home!' %> </h1>
    <nav>
      <a id="station" href="#" class="control">
        <small>Listening to</small>
        <strong>Popular Today</strong>
      </a>
      <ul>
        <li><%= link 'New', '/songs-new', :id => 'nav-songs-new' %></li>
        <li><%= link 'Popular', '/songs', :id => 'nav-songs' %></li>
        <li><%= link 'Stations', '/blogs', :id => 'nav-blogs' %></li>
        <li><%= link 'Artists', '/artists', :id => 'nav-artists' %></li>
      </ul>
    </nav>

    <div id="bar">
      <div id="player">
        <div id="player-controls" class="player-buttons">
          <%= link_to '<span>4</span>'.html_safe, '#', :class => 'play pictos control', :id => 'player-play', :title => 'Play/pause' %>
          <%= link_to '<span>7</span>'.html_safe, '#', :class => 'next pictos control', :id => 'player-next', :title => 'Next song' %>
        </div>
        <div id="player-main">
          <h2 id="player-meta">
            <span id="player-artist-name">&nbsp;</span>
            <strong id="player-song-name">&nbsp;</strong>
          </h2>
          <div id="player-bottom">
            <%= link_to '>', '#', :class => 'volume pictos control', :id => 'player-volume', :title => 'Volume on/off' %>
            <div id="player-progress-bar">
              <div id="player-progress-grabber"></div>
              <div id="player-progress-position"></div>
              <div id="player-progress-loaded"></div>
              <img id="player-progress-waveform" src="/images/transparent.png" />
            </div>
            <div id="player-playlist">
              <ul class="songs">
                {{#songs}}
                <li>
                  <a class="control song-{{id}}" href="#song-{{id}}" data-index="{{id}}">
                    <span class="artist">{{artist}}</span> - <span class="name">{{name}}</span>
                  </a>
                </li>
                {{/songs}}
              </ul>
            </div>
            <%= link_to 'k', '#', :class => 'add pictos control tip-n', :id => 'player-add', :title => 'Add to favorites' %>
          </div>
        </div>
      </div>
      <div id="player-invite-container"><a id="player-invite" class="tip-n control disabled" title="Send this song to friends!" data-hover="Copy!" data-click="Copied!">Share!</a></div>

      <div id="player-share">
        <%= link_to 'Share on Facebook', '#', :id => 'share-facebook', :class => 'facebook control popup tip-n', :title => 'Share on Facebook', :'data-dimensions' => '500,500' %>
        <%= link_to 'Share on Twitter', '#', :id => 'share-twitter', :class => 'twitter control popup tip-n', :title => 'Share on Twitter', :'data-dimensions' => '500,500' %>
      </div>
    </div>

    <div id="second-nav">
      <%= link 'New', '/songs-new', :class => 'pictos-new' %>
      <%= link 'Artists', '/artists', :class => 'pictos-artists' %>
      <%= link 'Popular', '/songs', :class => 'pictos-popular' %>
      <%= link 'Stations', '/blogs', :class => 'pictos-stations' %>
    </div>

    <div id="functions">
      <div class="nav">
        <% if user_signed_in? %>
          <span id="current_user" data-id="<%= current_user.id %>"></span>
          <%= link_to "#{current_user.username}".html_safe, edit_user_registration_path, :id => 'nav-username', :class => 'control' %>
          <div class="nav-dropdown">
            <div id="nav-user">
              <%= link_to "Home", '/home' %>
              <%= link_to "#{image_tag(current_user.avatar.url(:small))} My Station".html_safe, current_user %>
              <%= link_to "Account".html_safe, '/users/edit' %>
              <%= link_to 'Log Out', destroy_user_session_path, :method => 'delete', :class=> 'control' %>
            </div>
          </div>
        <% else %>
          <%= link_to 'Login', new_user_session_path, :class => 'inline', 'data-target' => 'new_user' %>
          <%= link_to 'Signup', new_user_registration_path, :class => 'inline', 'data-target' => 'new_user'  %>
        <% end %>
      </div>
    </div>

    <%= form_tag '/main/search', :method => 'get' do %>
      <%= text_field_tag :query, '', :placeholder =>"Search #{@count[:blogs]} blogs, #{@count[:songs]} songs" %>
      <%= submit_tag :s, :id => 'search', :class => 'pictos tip-n', :title => 'Search!' %>
    <% end -%>
  </header>

  <div id="main-mid">
    <div class="page-contain">
      <div id="announce">
        <div id="announce-contain">
          <strong>The best music from all over the web</strong>
          <span>Follow all your favorite music, create a station and listen with friends!</span>
        </div>
      </div>

      <%- if notice -%>
      <div id="dialog" class="notice"><%= notice %></div>
      <%- elsif alert -%>
      <div id="dialog" class="alert"><%= alert %></div>
      <%- end -%>

      <div id="body">
        <%= yield %>
      </div>

      <footer>
        <!-- <span class="credits">Website thumbnails provided by <a href='http://www.bitpixels.com/'>BitPixels</a></span> -->
      </footer>
    </div>
  </div>

  <a id="debug" class="control" href="">d</a>
  <div id="debug_dump"></div>

  <%= javascript_include_tag "application", :debug => Rails.env.development? %>

  <!-- mathiasbynens.be/notes/async-analytics-snippet Change UA-XXXXX-X to be your site's ID
  <script>
    var _gaq=[['_setAccount','UA-XXXXX-X'],['_trackPageview'],['_trackPageLoadTime']];
    (function(d,t){var g=d.createElement(t),s=d.getElementsByTagName(t)[0];g.async=1;
    g.src=('https:'==location.protocol?'//ssl':'//www')+'.google-analytics.com/ga.js';
    s.parentNode.insertBefore(g,s)}(document,'script'));
  </script> -->

  <!-- Modals -->
  <div id="overlay"><div id="modal"></div></div>

  <div class="hidden">
    <div id="new_user">
      <div class="half first">
        <h4>Login</h4>
        <%= render :partial => 'sessions/new_form' %>
      </div>
      <span id="between">or</span>
      <div class="half">
        <h4>Signup</h4>
        <%= render :partial => 'registrations/new_form' %>
      </div>
    </div>
  </div>
</body>
</html>